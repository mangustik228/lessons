!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ali/wpk-reporter")):"function"==typeof define&&define.amd?define(["exports","@ali/wpk-reporter"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).iLogger={},e.wpkReporter)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t),r=!1;function i(){if(!r){var e=function(e){var t=e.name,n=e.responseStart,r=e.fetchStart,i=e.domainLookupEnd,a=e.domainLookupStart,c=e.requestStart,l=e.responseEnd,s=e.connectEnd,d=e.connectStart,u=e.transferSize,f=e.decodedBodySize;try{var p={category:204,msg:new URL(t).hostname,wl_avgv1:n-r,wl_avgv2:i-a,wl_avgv3:s-d,wl_avgv4:n-c,wl_avgv5:l-n,wl_avgv6:l-r,wl_avgv7:u,wl_avgv8:f,c1:t,bl_1:o,sampleRate:.05};n>0&&window.__wpk.report(p)}catch(e){}},t=function(t){window.requestIdleCallback?window.requestIdleCallback((function(){e(t)})):setTimeout((function(){e(t)}),0)},n=function(e){e.filter((function(e){var t=e.initiatorType,n="css"===t&&e.name.endsWith(".css"),o="link"===t&&(e.name.endsWith(".js")||e.name.endsWith(".css"));return"script"===t||n||o})).forEach(t)};if(r=!0,!window.__wpk)return;var o=new URL(location.href).searchParams.get("wh_pid")||location.pathname;if(console.log("[lzd-h5-itrace] init asset perf monitor"),window.performance&&window.PerformanceObserver){var i="resource",a=window.performance.getEntriesByType(i);n(a),new PerformanceObserver((function(e){n(e.getEntries())})).observe({entryTypes:[i]})}}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);l=!0);}catch(e){s=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw r}}return c}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function p(e){return window.__PAGE_NAME?"".concat(window.__PAGE_NAME,"-").concat(e):e}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||window.location.search.slice(1),n=t.split("&").reduce((function(e,t){var n=d(t.split("="),2),o=n[0],r=n[1];return e[o]=r,e}),{});return n}function g(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(e.split("\r\n"));try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.indexOf("x-eagleeye-id")>-1){var r=o.split(":");return r[1]?r[1]:""}}}catch(e){n.e(e)}finally{n.f()}return""}function m(){return(navigator.userAgent||"").toLowerCase().indexOf("android")>-1}function h(){var e="",t=document.head.querySelector('meta[name="wpk-pid"]'),n=document.head.querySelector('meta[name="wpk-bid"]'),o=t||n;return o&&o.getAttribute("content")&&(e=o.getAttribute("content")),e}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"POST";0!==e.indexOf("/")&&(e="/".concat(e));var r=Object.keys(n).map((function(e){return"".concat(e,"=").concat("string"==typeof n[e]?n[e]:JSON.stringify(n[e]))})).join("&");window.goldlog&&window.goldlog.record?window.goldlog.record(e,t,r,"POST"===o?"POST":"GET"):(window.goldlog_queue||(window.goldlog_queue=[])).push({action:"goldlog.record",arguments:[e,t,r,"POST"===o?"POST":"GET"]})}var _=0,y=0;function b(e,t,n,o){var r=function(e,t){return t||(_=_||performance.timeOrigin,e?e-_:+new Date-_-0)}(e,t),i=+new Date;y=performance.now()||0,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!(window.WindVane||{}).isAvailable)return!1;var o=location,r=o.origin+o.pathname;r=window.__SSR_STATUS__?o.search?r+o.search+"&pageType=SourcePageSSR"+o.hash:r+"?pageType=SourcePageSSR"+o.hash:location.href,window.WindVane&&window.WindVane.call("LACustomWVPlugin","reportPerformanceInfo",{webViewType:n,url:r,containerType:"object"===l(window.__pha_environment__)?1:0,firstScreenPaint:e,firstScreenPaintTimeStamp:t},(function(){console.log("[component_did_mount_hook] report time to App",e)}),(function(e){console.log("err",e)}))}(r,i),function(e,t,n,o){window.__wpk&&window.__wpk.report&&(window.__wpk.report(Object.assign({category:203,msg:p("componentDidMount"),wl_avgv1:e,c1:e,c2:_,c3:t||"-",c4:0,c5:y,c6:window.__SSR_STATUS__?"SourcePageSSR":""},o)),console.log("[component_did_mount_hook] report time to iTrace",e))}(r,i,0,o)}window.__WindVane=window.WindVane||{};var T,S=function(){window.lzdiTraceLifeCircle=window.lzdiTraceLifeCircle||{},window.lzdiTraceLifeCircle.lzdiTraceShareDidMountTime=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.rocket_pre_hot)return null;"function"==typeof window.clearTraceLifeQueue&&window.clearTraceLifeQueue(),v("/lzdfe.pageModule.exp","EXP"),b(e,t,0,n),window.lzdiTraceLifeCircle&&window.lzdiTraceLifeCircle.FirstScreenRenderingEnd()},window.lzdiTraceLifeCircle&&window.lzdiTraceLifeCircle.FirstScreenRenderingStart()};function O(e){return e.split(".").map((function(e){return parseInt(e,10)}))}function E(e){var t=function(){if(void 0!==T)return T;var e=navigator.userAgent.match(/AliApp\(LA\/(\d+.\d+.\d+)\)/);return T=e&&e.length>1?e[1]:""}();return!!function(e){return/^\d+(\.\d+)+$/.test(e)}(t)&&function(e,t){for(var n=O(e),o=O(t),r=0;r<Math.max(n.length,o.length);r++){if(n[r]>o[r])return 1;if(n[r]<o[r])return-1}return 0}(t,e)>=0}function x(){var e=window.navigator.userAgent;return/Android/.test(e)?"android":/(iPhone|iPod)/.test(e)?"ios":/Windows\sPhone/.test(e)?"windows_phone":"unknown"}var P=function(e){if("unknown"!==x()&&("ios"!==x()||E("7.2.0"))&&("android"!==x()||E("7.3.0"))&&window.WindVane)try{window.WindVane.call("LAWVNexpInfo","reportNexpInfo",e,(function(){console.log("reportNexpInfo:",e)}),(function(e){console.warn("reportNexpInfo failed:",e)}))}catch(e){console.error("report badcase error:",e)}},k=function(e){return Math.random()<e},I=function(e){return"string"==typeof e?parseInt(e):e},L={},R=[],C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(E("7.4.0"))if("function"==typeof window.clearTraceLifeQueue&&window.clearTraceLifeQueue(),window.WindVane){(e=[].concat(e)).forEach((function(e){if(e.event&&e.time&&(L[e.event]=e.time,"first_screen_rendering_end"===e.event&&e.costTime>3e3||"fsp_end"===e.event&&e.costTime>5e3)){var t=w();P({module:"h5_perf",subModule:window.location.href,info:c(c({},e),{},{query:t,timeline:L})})}}));try{window.WindVane.call("LACustomWVPlugin","reportLifecycle",{lifecycles:e},(function(){console.log("reportLifecycle:",e)}),(function(e){console.warn("reportLifecycle failed:",e)}))}catch(e){console.error("report lifecyle error:",e)}}else R.push(e)},D=function(){window.lzdiTraceLifeCircle=window.lzdiTraceLifeCircle||{};var e=window.performance.timing||{};window.lzdiTraceLifeCircle.NativePrefetchEnd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;C({event:"native_prefetch_end",time:e||Date.now()})},window.lzdiTraceLifeCircle.FirstScreenRenderingStart=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;C({event:"first_screen_rendering_start",time:t||e.responseStart})},window.lzdiTraceLifeCircle.FirstScreenRenderingEnd=function(){C({event:"first_screen_rendering_end",time:Date.now(),costTime:Date.now()-(L.first_screen_rendering_start||e.responseStart)})},window.lzdiTraceLifeCircle.FSPStart=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;C({event:"fsp_start",time:t||e.responseStart})},window.lzdiTraceLifeCircle.FSPEnd=function(){C({event:"fsp_end",time:Date.now(),costTime:Date.now()-(L.fsp_start||e.responseStart)})},window.lzdiTraceLifeCircle.FetchSSRDataStart=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;C({event:"fetch_ssr_data_start",time:t||e.domComplete})},window.lzdiTraceLifeCircle.FetchSSRDataEnd=function(){C({event:"fetch_ssr_data_end",time:Date.now(),costTime:Date.now()-(L.fetch_ssr_data_start||e.domComplete)})},window.lzdiTraceLifeCircle.FetchFirstScreenDataStart=function(e){e&&C({event:"fetch_first_screen_data_start",time:e})},window.lzdiTraceLifeCircle.FetchFirstScreenDataEnd=function(e){e&&C({event:"fetch_first_screen_data_end",time:e,costTime:e-L.fetch_first_screen_data_start})},window.lzdiTraceLifeCircle.PageRenderingEnd=function(){C({event:"page_rendering_end",time:Date.now(),costTime:Date.now()-(L.page_rendering_start||e.responseStart)})},console.log("[lzd-h5-itrace] lifecyle report plugin ready"),document.addEventListener("DOMContentLoaded",(function(){C(R)}))},N=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e?null:{},o=document.cookie?document.cookie.split("; "):[],r=/(%[0-9A-Z]{2})+/g,i=0;i<o.length;i++){var a=o[i].split("="),c=a.slice(1).join("=");t.json||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=a[0].replace(r,decodeURIComponent);if(c=c.replace(r,decodeURIComponent),t.json)try{c=JSON.parse(c)}catch(e){}if(e===l){n=c;break}e||(n[l]=c)}catch(e){}}return n},j={ID:{id:"360",lang:["id","en"],langShort:["id","en"],currency:"IDR",domain:"lazada.co.id",regionID:"ID"},MY:{id:"458",currency:"MYR",lang:["en-MY","ms","zh"],langShort:["en","ms","zh"],domain:"lazada.com.my",regionID:"MY"},PH:{id:"608",currency:"PHP",lang:["en-PH"],langShort:["en"],domain:"lazada.com.ph",regionID:"PH"},SG:{id:"702",currency:"SGD",lang:["en-SG","zh"],langShort:["en","zh"],domain:"lazada.sg",regionID:"SG"},TH:{id:"764",currency:"THB",lang:["th","en"],domain:"lazada.co.th",regionID:"TH"},VN:{id:"704",currency:"VND",lang:["vi","en"],domain:"lazada.vn",regionID:"VN"}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e;if(e.includes("?")){var o=e.split("?"),r=d(o,2),i=r[1];n=void 0===i?"":i}if(n.includes("#")){var a=n.split("#"),c=d(a,1),l=c[0];n=void 0===l?"":l}for(var s=n.split("&"),u={};s.length;){var f=s.shift(),p=f.split("="),w=d(p,2),g=w[0],m=void 0===g?"":g,h=w[1],v=void 0===h?"":h;m&&(u[m]=t?decodeURIComponent(v):v)}return u},z=navigator.userAgent||"",M=A();function H(e){return e?e.split("|"):[]}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e=e.toLocaleUpperCase();var n=j[e]?j[e].lang:[];if(!Array.isArray(n))return t;for(var o="",r=0;r<n.length;r++){var i=n[r];if(i&&i.indexOf(t)>-1){o=i;break}}return o||(o=n[0]),o}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function q(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var W={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==l(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload",qg:"http://px-itrace.xuexi.cn/api/v1/jssdk/upload",qg_https:"https://px-itrace.xuexi.cn/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig",qg:"http://px-itrace.xuexi.cn/api/v1/jconfig",qg_https:"https://px-itrace.xuexi.cn/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},,,function(e,t,n){var o=n(0).env,r=function(e){var t;return(e&&(t=e.replace(/^#\/?/,""))&&"string"==typeof t?t.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):"")||"[index]"},i=function(e,t){if(t=t||{},e.env===o.BROWSER&&window)if(e.toolKit.extend({enable:!0},t).enable){e.logger.info("wpkflowPlugin已开启");var i,a,c=function(){e.reportFlow()};"complete"===document.readyState?setTimeout(c,0):e.toolKit.onListen(window,"load",c,!0),e.spa&&(n(4)(),i=function(t){r(location.hash)&&(e._begin=Date.now(),e._sid=e.toolKit.getSessionId(),e.reportFlow())},a=function(t){r(t.detail)&&(e._begin=Date.now(),e._sid=e.toolKit.getSessionId(),e.reportFlow())},e.toolKit.onListen(window,"hashchange",i),e.toolKit.onListen(window,"historystatechange",a)),e.toolKit.onListen(window,"beforeunload",(function(){e.toolKit.offListen(window,"load"),e.toolKit.offListen(window,"hashchange"),e.toolKit.offListen(window,"historystatechange"),c=i=a=null}))}else e.logger.info("wpkflowPlugin已关闭")};i.prototype.pluginId="flow",e.exports=i},function(e,t){var n=window.history||{},o=window.document,r=function(e,t){var n;window.CustomEvent?n=new CustomEvent(e,{detail:t}):((n=o.createEvent("HTMLEvents")).initEvent(e,!1,!0),n.detail=t),window.dispatchEvent(n)},i=function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):""},a=function(e){var t=n[e];"function"==typeof t&&(n[e]=function(e,o,a){var c=location.href,l=t.call(n,e,o,a);if(!a||"string"!=typeof a)return l;if(a===c)return l;try{var s=c.split("#"),d=a.split("#"),u=i(s[0]),f=i(d[0]),p=s[1]&&s[1].replace(/^\/?(.*)/,"$1"),w=d[1]&&d[1].replace(/^\/?(.*)/,"$1");u!==f?r("historystatechange",f):p!==w&&r("historystatechange",w)}catch(e){}return l},n[e].toString=e+"() { [native code] }")};e.exports=function(){a("pushState"),a("replateState")}}])}(W);var G=q(W.exports),K={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==l(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({0:function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload",qg:"http://px-itrace.xuexi.cn/api/v1/jssdk/upload",qg_https:"https://px-itrace.xuexi.cn/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig",qg:"http://px-itrace.xuexi.cn/api/v1/jconfig",qg_https:"https://px-itrace.xuexi.cn/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},6:function(e,t,n){var o=n(0),r=o.sdk,i=o.http.methods,a=o.category,c=function(e){return e>=200&&e<=299},l=function(e){return-1===e.indexOf("//arms-retcode")&&-1===e.indexOf("//retcode.taobao.com")&&-1===e.indexOf("aliyuncs.com/r.png")&&-1===e.indexOf("//mdap.alipay.com/loggw")&&-1===e.indexOf("//wpk-gateway")&&-1===e.indexOf("//px.ucweb.com")&&-1===e.indexOf("//px.effirst.com")&&-1===e.indexOf("//px-intl.ucweb.com")&&-1===e.indexOf("//gm.mmstat.com/arms.1.1")&&-1===e.indexOf("//gm.mmstat.com/arms.1.2")&&-1===e.indexOf("//g.alicdn.com/alilog")&&-1===e.indexOf("//log.m.sm.cn/0.gif")},s=function(e,t){if(e.hasOwnProperty(t))return e[t]},d=function(e,t,n){e.toolKit.isObject(n)&&e.toolKit.extend(t,{c1:s(n,"c1"),c2:s(n,"c2"),c3:s(n,"c3"),c4:s(n,"c4"),c5:s(n,"c5"),bl1:s(n,"bl1"),bl2:s(n,"bl2"),bl3:s(n,"bl3"),bl4:s(n,"bl4"),bl5:s(n,"bl5")}),e.report(t)},u=location.origin,f=function(e){return!e||0===e.indexOf(u)||!/^(\/\/|http:|https:).*/.test(e)};function p(e,t){var n=null;try{var o,r,i,a=e.toolKit.trim(t||"").split(/[\r\n]+/);a.length>0&&(n={},e.toolKit.forEach(a,(function(e){o=e.split(": "),r=o.shift(),i=o.join(": "),n[r]=i})))}catch(e){}return n}function w(e,t,n){var o={};return e.toolKit.forEach(Object.getOwnPropertyNames(t),(function(e){-1!==n.indexOf(e)&&(o[e]=t[e])})),o}function g(e){try{if(!e)return{};var t={};return e.forEach((function(e,n){t[n]=e})),t}catch(e){return{}}}var m=function(e,t){if(e.env===o.env.BROWSER&&window){var n={enable:!0,sampleRate:1,enableTrace:!1,enableCorsTrace:function(e){return!1},requestHeaders:{"x-wpk-reqid":function(){return e.toolKit.uuid(!1)},"x-wpk-bid":function(){return e.bid}},responseHeaders:["x-eagleeye-id","x-wpk-serverid"]},s=e.toolKit.extend(n,t);s.enable?(e.logger.info("wpkinterfacePlugin已开启"),"XMLHttpRequest"in window&&function(e,t){var n=window.XMLHttpRequest.prototype,o=n.open;n.open=function(n,r){this.__reqCtx__={method:n,url:r||"",start:Date.now()};var i=[].slice.call(arguments);o.apply(this,i);var a=this;t.enableTrace&&(f(r)||t.enableCorsTrace(r))&&e.toolKit.forEach(Object.getOwnPropertyNames(t.requestHeaders),(function(e){var n=t.requestHeaders[e]();a.setRequestHeader(e,n)}))};var s=n.setRequestHeader;n.setRequestHeader=function(e,t){var n=[].slice.call(arguments);s.apply(this,n),this.__reqCtx__&&(this.__reqCtx__.headers||(this.__reqCtx__.headers={}),this.__reqCtx__.headers[e]=t)};var u=n.send;n.send=function(n){var o=this;function s(){if(o.__reqCtx__&&4===o.readyState)try{var s=Date.now(),u=(o.responseURL||o.__reqCtx__.url).split("?"),f=u[0],g=u[1]||"",m="",h=o.__reqCtx__.headers||{};o.__reqCtx__.method.toUpperCase()!==i.GET&&n&&(m=JSON.stringify(n));var v=p(e,o.getAllResponseHeaders()),_=String(o.response),y=!0,b={};"function"==typeof t.errorFilter&&(y=!!(b=t.errorFilter.call(this,{url:f,status:o.status,response:_,body:m,queryString:g,reqHeaders:h,resHeaders:v})),e.logger.warn("api errorFilter执行结果：",b)),_.length>2048&&(_="[response content too large]");var T=s-o.__reqCtx__.start;if(y&&T<121e3&&l(f)){var S=b.bizCode||o.status,O=b.reqHeaders||h,E=b.resHeaders||w(e,v,t.responseHeaders),x={category:a.API,sampleRate:t.sampleRate,w_res:f,w_param:g,w_body:c(S)||!t.withBody?"":m,w_method:o.__reqCtx__.method,w_rc:S,w_rt:T,w_resp:c(S)||!t.withResp?"":b.resp||_,w_hd:JSON.stringify(O),w_trace_reqid:O&&O["x-wpk-reqid"]||void 0,w_rshd:JSON.stringify(E),w_trace_serverid:E&&E["x-wpk-serverid"]||void 0,msg:b.msg||"",w_type:16};d(e,x,b)}}catch(t){e.reportError(t,{bid:r.BID,cid:r.CID,category:a.JSERR,sampleRate:1})}}if("onreadystatechange"in o&&"function"==typeof o.onreadystatechange){var f=o.onreadystatechange;o.onreadystatechange=function(){var e=[].slice.call(arguments);s.apply(this,e),f.apply(this,e)}}else o.onreadystatechange=s;var g=[].slice.call(arguments);return u.apply(this,g)}}(e,s),"fetch"in window&&function(e,t){var n=window.fetch;window.fetch=function(){var o=[].slice.call(arguments),s=i.GET;o[1]&&o[1].method&&(s=o[1].method.toUpperCase());var u,p=o[0];u="string"==typeof p?p:p instanceof URL?p.toString():p.url||"",t.enableTrace&&(f(u)||t.enableCorsTrace(u))&&(o[1]?void 0===o[1].headers&&(o[1].headers={}):o[1]={headers:{}},e.toolKit.forEach(Object.getOwnPropertyNames(t.requestHeaders),(function(e){o[1].headers[e]=t.requestHeaders[e]()})));var m=Date.now();return n.apply(this,o).then((function(n){try{var u=Date.now(),f=(n.url||o[0]).split("?"),p=f[0],h=f[1]||"",v="",_=null;o[1]&&(_=o[1].headers),s!==i.GET&&o[1]&&o[1].body&&(v=JSON.stringify(o[1].body));var y=n.clone(),b=g(y.headers);y.text().then((function(o){o=o||"";var r=!0,i={};if("function"==typeof t.errorFilter&&(r=!!(i=t.errorFilter.call(this,{url:p,status:n.status,response:o,body:v,queryString:h,reqHeaders:_,resHeaders:b})),e.logger.warn("api errorFilter执行结果：",i)),o=o.length>2048?"[response content too large]":o,r&&u-m<121e3&&l(p)){var f=i.bizCode||n.status,g=i.reqHeaders||_,y=i.resHeaders||w(e,b,t.responseHeaders),T={category:a.API,sampleRate:t.sampleRate,w_res:p,w_param:h,w_body:c(f)||!t.withBody?"":v,w_method:s,w_rc:f,w_rt:u-m,w_resp:c(f)||!t.withResp?"":i.resp||o,w_hd:JSON.stringify(g),w_trace_reqid:g&&g["x-wpk-reqid"]||void 0,w_rshd:JSON.stringify(y),w_trace_serverid:y&&y["x-wpk-serverid"]||void 0,msg:i.msg||"",w_type:16};d(e,T,i)}}))}catch(t){e.reportError(t,{bid:r.BID,cid:r.CID,category:a.JSERR,sampleRate:1})}return n})).catch((function(e){throw e}))}}(e,s),(e.enableMtop||s.enableMtop)&&(e.logger.info("use mtop"),function(e,t){window&&window.lib.mtop&&window.lib.mtop.middlewares&&window.lib.mtop.middlewares.push((function(n){var o=this.params,i=this.options,s=Date.now();return n().then((function(){try{if(i.H5Request&&(i.getJSON||i.postJSON))return void e.logger.debug("识别到请求为xhr, api监控交由xhr的方式处理");var n,u=i.retJson||{},f=Date.now()-s,p=u.code||200,w=o.type,g=o.api,m=e.toolKit.objToQueryString(i.querystring),h=i.postdata&&i.postdata.data?e.toolKit.objToJsonString(i.postdata.data):null,v=e.toolKit.objToJsonString(u.data||{}),_=u.ret;_ instanceof Array&&(_=_.join(",")),-1===_.indexOf("SUCCESS")&&(n=_);var y=!0,b={};if("function"==typeof t.errorFilter&&(y=!!(b=t.errorFilter.call(this,{url:g,status:p,response:v,body:h,queryString:m,msg:n})),e.logger.warn("api errorFilter执行结果：",b)),y&&f<121e3&&l(g)){var T=b.bizCode||p,S={category:a.API,sampleRate:t.sampleRate,w_res:g,w_param:m,w_body:c(T)||!t.withBody?"":h,w_method:w,w_rc:T,w_rt:f,w_resp:c(T)||!t.withResp?"":b.resp||v,msg:b.msg||n||"",w_type:16};d(e,S,b)}}catch(t){e.reportError(t,{bid:r.BID,cid:r.CID,category:a.JSERR,sampleRate:1})}}))}))}(e,s))):e.logger.info("wpkinterfacePlugin已关闭")}};m.prototype.pluginId="api",e.exports=m}})}(K);var U=q(K.exports),B={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==l(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload",qg:"http://px-itrace.xuexi.cn/api/v1/jssdk/upload",qg_https:"https://px-itrace.xuexi.cn/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig",qg:"http://px-itrace.xuexi.cn/api/v1/jconfig",qg_https:"https://px-itrace.xuexi.cn/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},function(e,t,n){var o=n(0),r=function(e,t){if(e.env===o.env.BROWSER&&"undefined"!=typeof window){var n={enable:!0,sampleRate:(t=t||{}).sampleRate||1,rootNode:t.rootNode,ignorePageUrls:t.ignorePageUrls||null,maxDepth:t.maxDepth||8,minElements:t.minElements||10,keyNoteText:t.keyNoteText||[],onloadDuration:t.onloadDuration||8e3,wsDuration:t.wsDuration||3e3,startCheckingTime:t.startCheckingTime||5e3},r=e.toolKit.extend(n,t);if(r.enable){e.logger.info("wpkblankPagePlugin已开启");try{if(e.toolKit.isFunction(r.ignorePageUrls)&&r.ignorePageUrls(location))return void e.logger.info("当前页面在白屏检测的白名单中")}catch(e){}var i=!1;if(r.onloadDuration>0&&"complete"!==document.readyState)var a=setTimeout((function(){i=!0,e.reportBlankPage({w_fp:100,w_wst:r.onloadDuration}),clearTimeout(a)}),r.onloadDuration);var c=function(){clearTimeout(a);try{!i&&r.wsDuration>0&&function(e,t){var n=performance.timing;if("function"==typeof window.PerformanceNavigationTiming)try{var o=performance.getEntriesByType("navigation")[0];o&&(n=o)}catch(e){}if(n)try{n.responseEnd-n.fetchStart>=e&&t()}catch(e){}}(r.wsDuration,(function(){e.reportBlankPage({w_fp:104,w_wst:r.wsDuration})}));var t=setTimeout((function(){!function(e,t){var n,r,i,a,c,l=0,s=0,d=!1,u=[],f=function(e){return 0===e.style.width||0===e.style.height||"none"===e.style.display||0===e.style.opacity||"hidden"===e.style.visibility||"collapse"===e.style.visibility||void 0!==e.type&&"hidden"===e.type},p=function(e){return e&&-1!==["VIDEO","IMG","BUTTON","TEXTAREA","RADIO","CHECKBOX","SELECT","IFRAME","CANVAS","SVG"].indexOf(e.nodeName)},w=function n(o,r){for(var i=Array.prototype.slice.call(o);i.length;){var a=i.shift();r>l&&(l=r),u.push({tag:a.tagName,layer:r,cls:a.className});var c=f(a);if(e.logger.info("depth："+r,a.nodeType,a.tagName,c),!c){if(s++,p(a)){d=!0,e.logger.info("有可见元素，非白屏");break}r<=t.maxDepth&&!f(a)&&a.children.length&&n(a.children,r+1)}}},g=!1;if(r=t.rootNode?"function"==typeof t.rootNode?t.rootNode():t.rootNode:document.body)if(i=r.innerText)a=t.keyNoteText,c=i,e.toolKit.some(a,(function(e){return e===c}))?(g=!0,n=102,e.logger.warn("肯定白屏，命中关键字",i)):(g=!1,d=!0);else{var m=Array.prototype.slice.call(r.children);w(e.toolKit.filter(m,(function(e){return-1===["STYLE","SCRIPT","LINK"].indexOf(e.nodeName)})),1)}else g=!0,n=103,e.logger.warn("白屏，木有body标签或者指定的root节点为空");e.logger.warn("元素数: ",s),e.logger.warn("遍历的最大层级: ",l),e.logger.warn("dsl",u),!g&&!d&&s<t.minElements&&(g=!0,n=101),g&&(e.logger.warn("白屏了",n),e.reportBlankPage({w_fp:n,w_dsl:JSON.stringify(u),w_depth:l,w_domcnt:s}),e.report({category:o.category.MAINDOC,sampleRate:1,bl1:JSON.stringify(document.documentElement.innerHTML),_forcePost:!0}),!e._hasCollectResTiming&&performance&&"function"==typeof performance.getEntriesByType&&(e.report({category:o.category.RESTIMING,bl1:JSON.stringify(performance.getEntriesByType("resource")),bl2:performance.timeOrigin||performance.timing.fetchStart,_forcePost:!0}),e._hasCollectResTiming=!0))}(e,r),clearTimeout(t)}),r.startCheckingTime)}catch(t){e.logger.error("bkpg checking oops: ",t)}};e.toolKit.onListen(window,"load",c,!0),e.toolKit.onListen(window,"beforeunload",(function(){e.toolKit.offListen(window,"load"),c=null}))}else e.logger.info("wpkblankPagePlugin已关闭")}};r.prototype.pluginId="bkpg",e.exports=r}])}(B);var J,V,X=q(B.exports),Y=m(),$=function(){Y||window.isTrace2||document.addEventListener("DOMContentLoaded",(function(){window.__wpk.addPlugin(X,{rootNode:document.getElementById("container")||document.getElementById("root")})}))},Q=h(),Z=(J=document.head.querySelector('meta[name="wpk-rel"]'))&&J.getAttribute("content")?J.getAttribute("content"):"",ee=A(),te=!!(V="object"===("undefined"==typeof location?"undefined":l(location))&&location.hostname||"")&&(V.indexOf("i.lazada.")>=0||V.indexOf("-p.lazada.")>=0||V.indexOf("pre-wormhole.")>=0||V.indexOf("pre.lazada.")>=0||V.indexOf("pre-www.lazada.")>=0||V.indexOf("pre-wallet-nav.lazada.")>=0||V.indexOf("-staging.lazada.")>=0)&&ee.iTraceDebug,ne=location.pathname.includes("/wow/i/sg/o2o-test/");var oe={bid:Q,cid:"",uid:N("lzd_uid"),utdid:N("utdid"),rel:Z||"2.0.3",cluster:"intl",debug:te||ne,beforeSend:function(e){var t,n;n=!1,1===(t=e).category&&k(.01)&&(n=!0),2===t.category&&200!==t.w_rc&&k(.1)&&(n=!0),4===t.category&&k(.1)&&(n=!0),200===t.category&&I(t.c1)>5e3&&(n=!0),202===t.category&&I(t.wl_avgv1)>6e3&&(n=!0),n&&P({module:"h5_itrace",subModule:t.w_bid,info:c({},t)});var o=(window.lzdiTraceLifeCircle||{}).lzdiTraceBeforeSend;try{return e&&o&&"function"==typeof o&&(e=o(e)),e}catch(t){return console.error("iTrace sdk beforeSend Format function execute error",t),e}}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"boolean"==typeof e.isDebug&&(e.debug=e.isDebug),e.pid&&(e.bid=e.pid),Object.assign({},oe,e)},ie=/AliApp/.test(z),ae=m(),ce="2.0.3",le=!!document.querySelector("meta[name='wpk-bid']"),se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(window.isTrace2)return console.log("--- itrace2Init ---"),de(e);if(e.pid){if("function"==typeof window.wpkReporter){var t=null;if(window.__wpk)e.pid&&(e.bid=e.pid,delete e.pid),window.__wpk.setConfig(e),t=window.__wpk;else{if(le&&ie&&ae){var n=re(c(c({},e),{},{plugins:[[G,{enable:!1}]]}));(t=new o.default(n)).install()}else{var r=re(c(c({},e),{},{plugins:[[U,{enable:!1}]]}));(t=new o.default(r)).installAll(),$()}window.__wpk=t}return console.log("lzd-h5-itrace version: v".concat(ce)),t}console.warn("wpk-reporter is not ready.")}else console.warn("[lzd-h5-itrace] 实例化失败，缺少必要参数")},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.pid){var t=re(e);return window.__wpk.setConfig(t),window.__wpk}console.warn("[lzd-h5-itrace] 实例化失败，缺少必要参数")},ue=!1,fe=function(e){if(!ue){var t=function(e){var t=e.name,n=e.duration,o=void 0===n?0:n,r=e.decodedBodySize,i=void 0===r?0:r,a=e.encodedBodySize,c=void 0===a?0:a,l=e.transferSize,s=void 0===l?0:l;try{var d=new URL(t);window.__wpk.report({category:202,msg:d.hostname,wl_avgv1:o.toFixed(2),wl_avgv2:i,wl_avgv3:c,wl_avgv4:s,c1:t,bl5:JSON.stringify(e),sampleRate:.01})}catch(e){}},n=function(e){var n=function(e){var t,n=new URL(e.name);return"https:"!==n.protocol&&"http:"!==n.protocol||"img"!==e.initiatorType||(t=n.hostname).includes("member.lazada.")||t.includes("my.lazada.")||t.includes("www.lazada.")||t.includes("pages.lazada.")||t.includes("c.lazada.")||t.includes("www.google.")||t.includes("translate.google.")||t.includes("criteo.net")||t.includes("doubleclick.net")||t.includes("googleadservices")||t.includes("cnzz.com")||t.includes("log.aliyuncs.com")||t.includes("mmstat.")||t.includes("clarity")||t.includes("ucweb.com")||t.includes("googleapis")||-1!==["graph.facebook.com","connect.facebook.net","csi.gstatic.com","airunit.taobao.com","acjs.aliyun.com","whos.amung.us","kcart.alipay.com","www.google-analytics.com","px-intl.ucweb.com","www.googletagmanager.com","googleads.g.doubleclick.net","www.facebook.com","gm.mmstat.com","sg.mmstat.com","bat.bing.com","cm.everesttech.net","pixel.everesttech.net","retcode-sg-lazada.arms.aliyuncs.com","fourier.taobao.com","pixel.tapad.com","secure.adnxs.com","s-cs.send.microad.jp","cs.adingo.jp"].indexOf(t)?null:e}(e);n&&(window.requestIdleCallback?window.requestIdleCallback((function(){t(n)})):setTimeout((function(){t(n)}),0))};if(ue=!0,console.log("[lzd-h5-itrace 2.0] init images perf monitor"),window.isTrace2&&window.__wpk.setConfig(e),window.__wpk||se(e),window.performance&&window.PerformanceObserver)window.performance.getEntriesByType("resource").forEach((function(e){n(e)})),new PerformanceObserver((function(e){e.getEntries().forEach((function(e){n(e)}))})).observe({entryTypes:["resource"]})}};var pe=function(){var e=[],t=screen.width*screen.height,n=null,o=!1,r=!1,i=["SCRIPT","LINK","SVG","IMG","VIDEO"],a=[];function c(e){var t=[];_(e,(function(e){_(e.addedNodes,(function(e){1===e.nodeType&&t.push(e)}))})),t.length>0&&w(t.concat([]))}var l=null;function s(e){o||(r=!0,n&&clearTimeout(n),l.disconnect(),l.takeRecords(),setTimeout((function(){o=!0,h(e)}),1e3))}var d=function(){};function u(t,n){var o=0===e.length,r=screen.width,i=screen.height,a=document.documentElement,c=a?Math.min(a.clientHeight,i):i,l=a?Math.min(a.clientWidth,r):r,s=t.left+t.width,d=t.top+t.height,u=Math.round(.02*Math.min(r,i)),f=Math.round(.05*i);return o?t.width>=n||t.height>=n?u:s>=u&&l-t.left>=u&&d>=f&&c-t.top>=f:t.width>=2*u&&t.height>=2*u&&s>=f&&l-t.left>=f&&d>=f&&c-t.top>2*f}function f(e,t,n){var o=n||0;return _(e,(function(e){o=t(e,o)})),o}function p(e){var t=function(){e.lastTime=Math.max(v(),e.lastTime),e.c=document.getElementsByTagName("*").length,g()};window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,0)}function w(n){var r=v(),c={createTime:r,lastTime:r,wait:0,piece:[],v:0,c:document.getElementsByTagName("*").length};_(n,(function(e){(function(e){for(var t=a.length,n=null,o=0;o<t;o++)if((n=a[o])&&n.contains&&n.contains(e))return!0;return!!e.hasAttribute("ignoreFspCollection")&&(a.push(e),!0)})(e)||function(e,n,r){var a=e.piece,c=document.documentElement.scrollTop||window.pageYOffset||document.body&&document.body.scrollTop||0,l=document.documentElement.scrollLeft||window.pageXOffset||document.body&&document.body.scrollLeft||0,s=r?null:n.getBoundingClientRect(),d=r||{type:0,className:"",top:s.top+c,left:s.left+l,width:s.width,height:s.height},w=n.offsetParent;w&&w.offsetWidth<w.scrollWidth&&(d.width=Math.min(w.offsetWidth,d.width)),w&&w.offsetHeight<w.scrollHeight&&(d.height=Math.min(w.offsetHeight,d.height));var m=n.tagName;if(-1!=i.indexOf(m.toUpperCase())&&"IMG"==m){var h=0;d.width=Math.max(d.width,1),d.height=Math.max(d.height,1),d.type=1,u(d)&&(e.wait+=1,n.addEventListener("load",(function r(){if(o)n.removeEventListener("load",r,!0);else{h++,e.wait-=1;var i=n.getBoundingClientRect(),a=v();u(d,!0)&&(h<=1||a<=1e3)?(d.width=i.width,d.height=i.height,e.lastTime=Math.max(a,e.lastTime),d.size=i.width*i.height,d.v=d.size/t,e.v=f(e.piece,(function(e,t){return e.v+t}),0),p(e)):g()}}),!0),n.addEventListener("error",(function t(){o?n.removeEventListener("error",t,!0):(e.wait-=1,u(d)?(e.lastTime=Math.max(v(),e.lastTime),0===e.wait&&(e.v=f(e.piece,(function(e,t){return e.v+t}),0),p(e))):g())}),!0))}var _={};if(window.getComputedStyle&&("none"===(_=window.getComputedStyle(n,null)).display||"fixed"===_.position))return a;if(u(d)){var y=_.backgroundImage||"",b=/url\(['"]?(.*?)['"]?\)/i;if(b.test(y)&&(y=y.replace(b,"$1"),!/^data:/i.test(y))){e.wait+=1;var T=document.createElement("img");T.onload=function(){e.wait-=1,e.lastTime=Math.max(v(),e.lastTime),0===e.wait&&p(e)},T.src=y}(function(e,t){var n=null;for(var o in e)if(n=e[o],t.top>=n.top&&t.left>=n.left&&t.top+t.height<=n.top+n.height&&t.left+t.width<=n.left+n.width)return!0;return!1})(a,d)||(d.size=d.width*d.height,d.v=d.size/t,e.v+=d.v,d.size&&a.push(d))}}(c,e)})),c.piece.length>0&&(e.push(c),p(c))}function g(){if(!r&&!o){n&&clearTimeout(n),n=setTimeout((function(){s()}),3e3);for(var t=null,i=null,a=0,c=0,l=0,d=0,u=0,f=e.length-1;f>1;f--){if(t=e[f],i=e[f-1],d=Math.floor(100*t.v)/100,c=(u=Math.floor(100*i.v)/100)?Math.abs(d-u)/u:0,(l+=Math.min(t.v,1))>4){s();break}if(c<.5){if(++a>6){s();break}}else a>0&&(a=0)}}}var m=0;function h(t){t&&(o=!0);var n=e.length;if(0!==n){var r=[],i=[],a=[],c=-1,l=0,u=0,f=0;for(f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,o=e.length-1,r=0;do{var i=e[o],a=e[o-1];if(!(Math.abs(i-a)/i<t))break;r++,o--}while(o>0);return r>=n&&o>0?Math.min(o,e.length-1):e.length-1}(e.map((function(e){return Math.floor(100*e.v)/100}))),i=f>0?e.slice(0,n+2):e;i.length>0;)if(c=i[0].lastTime,l=i[0].c,a=[],u=0,f=0,_(i,(function(e){u+=e.v,f++,e.createTime<=c+200&&(c=Math.max(c,e.lastTime),l=Math.max(l,e.c)),e.lastTime>c&&a.push(e)})),i=a,u<.02||u/f<.01?m++:m=0,r.push([c,l]),m>=3){r.splice(r.length-3),s();break}var p=r.length-1;0!==m&&p>=m&&(p-=m),p=r[p];var w=null,g=null;l=null;try{p&&(w=p[0],l=p[1],function(e,t,n){if(!window.dispatchEvent||!window.CustomEvent)return;var o={cost:t,timestamp:e,domSize:n},r=new CustomEvent("jstracker.fsp",{detail:o});window.__itrace_fsp_detail__=o,window.dispatchEvent(r)}(g=performance.timing.navigationStart+w,w,l)),d&&d(g,w,l)}catch(e){}}}function v(){return performance.now()}function _(e,t){if(Array.prototype.forEach)Array.prototype.forEach.call(e,t);else for(var n=e.length,o=0;o<n;o++)t(e[o],o)}return{install:function(){window.performance&&window.MutationObserver&&((l=new MutationObserver(c)).observe(document.documentElement,{childList:!0,subtree:!0}),w(document.querySelectorAll("BODY > *")),setTimeout((function(){s(!0)}),3e4))},onReport:function(e){e&&"function"==typeof e&&(d=e)},forceStop:function(){h(!0)}}}(),we=pe,ge=!1,me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ge){ge=!0,window.__wpk||se(e);var t="",n=window.lzdiTraceLifeCircle||{},o=n.FSPStart,r=function(n){var o=n.timestamp,r=n.time,i=n.domSize,a=n.ssrTime,c=void 0===a?"":a,l=window.lzdiTraceLifeCircle||{},s=l.lzdiTraceShareFspTime,d=l.FSPEnd;if(console.log("[fsp-report 2.0]",o,r,i,window.preLoadTime,c),window.__lzd_fsp_done=!0,window.__wpk&&window.__wpk.report){var u=Math.floor(r)-Math.floor(window.preLoadTime||0);if(window.__lzd_fsp_value=u,u>0&&u<2e4){var f=e.msg||"自定义首屏";f=p(f);var w=window.performance.getEntriesByType("navigation")[0],g=w&&w.responseEnd;window.__wpk.report({category:e.category||200,msg:f,wl_avgv1:u,wl_avgv2:window.__SSR_FS_TIME||void 0,wl_avgv3:g,wl_avgv4:c||void 0,c1:u,c2:r,c3:window.preLoadTime||"-",c4:t,c5:window.__SSR_TRACE_ID||"-"}),"function"==typeof s&&s({fspTime:u,preLoadTime:window.preLoadTime,url:location.href}),"function"==typeof d&&d()}else{var m=u<0?"负值":"极大值 (>20s)";window.__wpk.report({category:e.category||200,msg:"".concat(m),c1:u,c2:r,c3:window.preLoadTime||"-",c4:t})}}};if("function"==typeof o&&o(),window.fspTracker){window.__isSSR&&(t="SourcePageSSR");var i=function(e){var t=e.cost,n=e.timestamp,o=e.domSize,i=e.ssrTime;r({time:t,timestamp:n,domSize:o,ssrTime:i})};window.__FSP?i(window.__FSP):window.fspTracker.listeners.push((function(e){i(e)}))}else if(window.iLogger&&window.iLogger.fspTracker){var a=window.__itrace_fsp_detail__;a?r({timestamp:a.timestamp,time:a.cost,domSize:a.domSize}):window.iLogger.fspTracker.onReport((function(e,t,n){r({timestamp:e,time:t,domSize:n})}))}else we.install(),we.onReport((function(e,t,n){r({timestamp:e,time:t,domSize:n})}))}},he=[/c\.go\-mpulse\.net/,/ds\-aksb\-a\.akamaihd\.net\/RRT/,/s\.akamaihd\.net\/eum\/getdns\.txt/,/pre\-wormhole/],ve=["SUCCESS","UNION_NOT_MATCH_FREQUENCY","FAIL_SYS_TOKEN_EMPTY","FAIL_SYS_ILLEGAL_ACCESS","FAIL_SYS_TOKEN_EXOIRED","FAIL_SYS_TOKEN_ILLEGAL"],_e={SG:"acs-m.lazada.sg",ID:"acs-m.lazada.co.id",PH:"acs-m.lazada.com.ph",VN:"acs-m.pages.lazada.vn",TH:"acs-m.pages.lazada.co.th",MY:"acs-m.pages.lazada.com.my"},ye={en:"Network error, please try again later",id:"Kesalahan jaringan, coba lagi nanti",ms:"Ralat rangkaian, sila cuba lagi kemudian",my:"ကွန်ယက်ကိုအမှား, နောက်မှာထပ်ကြိုးစားကြည့်ပါ",th:"ข้อผิดพลาดของเครือข่ายโปรดลองอีกครั้งในภายหลัง",vi:"Lỗi mạng, vui lòng thử lại sau"},be=!1;function Te(){var e=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="",o="",r=H(N("hng"));if("object"===("undefined"==typeof window?"undefined":l(window))&&window._i18n_){var i=window._i18n_;if("string"==typeof i)try{i=JSON.parse(i)}catch(e){}"object"===l(i)&&(n=i.regionID,o=i.language)}if(!n&&window.g_config&&"object"===l(window.g_config)&&(n=window.g_config.regionID,o=window.g_config.language),!n&&"object"===("undefined"==typeof location?"undefined":l(location))&&location.hostname){for(var a in j){var c=j[a];if(c&&c.domain&&location.hostname.indexOf(c.domain)>-1){n=c.regionID;break}}r.length>1&&(o=r[1])}return n||r.length>=4&&(n=r[0],o=r[1]),t&&r.length>1&&(o=r[1]),o=F(n=M.wh_regionID||n||"SG",o)||"en",e&&(o=o.substring(0,2)),{regionID:n.toLocaleUpperCase(),language:o}}(),t=e.language;return ye[(void 0===t?"EN":t).toLowerCase()]||ye.en}var Se=function(e,t,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};he.some((function(t){return t.test(e)}))||window.__wpk.reportApi(c({msg:r,url:e,method:t,status:o,spent:n,response:o},i),{})},Oe=function(e){var t;be||(window.isTrace2?console.warn("mtop插件已经改变接入方式，参考xxx"):(window.__wpk||se(e),console.log("--- iLoggerMtopPluginInit ---"),window,(t=window.lib||(window.lib={}))&&t.mtop&&!t.mtop.ERROR?(t.mtop.middlewares.push((function(e){var t=this.params,n=this.options,o=n.querystring,r=parseInt((void 0===o?{}:o).t)||Date.now();return e().then((function(){var e,o,i,a="",c=n.retJson,l=void 0===c?{}:c,s=n.path,d=n.prefix,u=n.subDomain,f=n.pageDomain,p=(n.results[0]||{}).stat,w=void 0===p?{}:p,m=l.responseHeaders,h=void 0===m?"":m,v=l.ret,_=g(h),y=function(e){var t=e&&e.length&&e[0].split("::");return-1!==e[0].indexOf("FAIL_SYS")||-1!==e[0].indexOf("SYSTEM_ERROR")||-1!==e[0].indexOf("UNKNOWN_FAIL_CODE")||-1!==e[0].indexOf("TIMEOUT")?{key:t[0],displayMessage:Te()}:t&&t[1]?{key:t[0],displayMessage:t[1]}:{key:e[0],displayMessage:Te()}}(v),b=y.displayMessage,T=t.type||"",S=l.v||t.v||"",O=t["x-i18n-regionID"]||"-",E=_e[O.toUpperCase()]||O,x=l.api||t.api||"";x=x.toLowerCase(),console.log(" ---- mtop report ---- "),e=t.ext_headers&&t.ext_headers["x-uid"]||"",i=ve.includes(y.key)?200:0,o=w.oneWayTime||Date.now()-r,a=s?"https:".concat(s):u&&f?"https://".concat(d?d+".":"").concat(u,".").concat(f,"/gw/").concat(x,"/").concat(S):"https://".concat(E,"/gw/").concat(x,"/").concat(S),Se(a,T,o,i,y.key,{c1:e,c2:_,c3:b})}))})),be=!0,console.log("[lzd-h5-itrace] mtop itrace plugin init success!")):console.warn("[lzd-h5-itrace] Mtop 没有初始化，无法添加 Mtop Itrace 监控插件！请参考 Mtop 文档 http://gitlab.alibaba-inc.com/mtb/lib-mtop ",t)))},Ee=Oe,xe=[".webp",".png",".jpg",".gif"],Pe=!1,ke=function(e){if(window.IMG_PRELOAD_PROFILE_PLUGIN&&!Pe&&(Pe=!0,console.log("[lzd-h5-itrace 2.0] init preload profile monitor"),window.isTrace2&&window.__wpk.setConfig(e),window.__wpk||se(e),window.performance&&window.PerformanceObserver)){var t,n=window.performance.getEntriesByType("resource")||[],o=[],r=0,i=n.filter((function(e){if("link"===e.initiatorType&&xe.some((function(t){return e.name.endsWith(t)}))&&o.push(e),"link"===e.initiatorType&&e.name.endsWith(".css"))return r+=e.duration,t?e.responseEnd<t&&(t=e.responseEnd):t=e.responseEnd,!0}));if(!(i&&i.length&&o&&o.length))return;var a=[],c=[],l=0,s=0;o.forEach((function(e){e.requestStart>t?(a.push(e),l+=e.duration):(c.push(e),s+=e.duration)}));try{window.__wpk.report({category:206,msg:"Image Preload Profile",w_succ:a.length<1?1:0,wl_avgv1:c.length,wl_avgv2:a.length,wl_avgv3:r/(i.length||1),wl_avgv4:s/(c.length||1),wl_avgv5:l/(a.length||1),bl1:c.map((function(e){return e.name})).join(";"),bl2:a.map((function(e){return e.name})).join(";")})}catch(e){}}},Ie=h(),Le={},Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={selfDefineFSP:!0,mtopPluginInit:!0,imagesPerf:!0,assetPerf:!0,didMountTimeReport:!0,preloadProfile:!0},n=document.head.querySelector('meta[name="lzd-itrace-close-auto-monitor"]');if(n&&n.getAttribute("content")){var o=n.getAttribute("content").split(",");o.forEach((function(e){var n=e.trim();t[n]=!1}))}D(),t.selfDefineFSP?me(e):console.log("[lzd-h5-itrace] close auto run selDefineFSP"),t.imagesPerf?fe(e):console.log("[lzd-h5-itrace] close auto run iLoggerImagesPerf"),t.assetPerf?i():console.log("[lzd-h5-itrace] close auto run iLoggerAssetPerf"),window.lib&&window.lib.mtop&&t.mtopPluginInit?Ee(e):console.log("[lzd-h5-itrace] close auto run mtopPluginInit"),t.didMountTimeReport?S():console.log("[lzd-h5-itrace] disable didMountTimeReport"),t.preloadProfile?ke(e):console.log("[lzd-h5-itrace] close preload profile plugin")};window&&(window.isTrace2||function(e){window.addEventListener("oniLoggerMtopPluginInit",(function(e){Oe(e.detail)}),!1);var t=!0;window.lib?window.lib.mtop&&(t=!1):window.lib={},t&&Object.defineProperty(window.lib,"mtop",{get:function(){return window.__lzdlib_mtop__},set:function(t){window.__lzdlib_mtop__=t,Object.defineProperty(window.lib.mtop,"middlewares",{get:function(){return window.__lzdlib_mtop_middlewares__},set:function(t){var n=new CustomEvent("oniLoggerMtopPluginInit",{detail:e||{}});window.__lzdlib_mtop_middlewares__=t,window.dispatchEvent(n)},configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}(Le),Ie&&(se({pid:Ie}),Re({pid:Ie}))),e.iLoggerInit=se,e.iLoggerIntegrate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";try{t=se(e)}catch(e){console.log("[lzd-h5-itrace] catch iTrace sdk error, make program go on!")}return Re(e),Le=e,t},e.iLoggerMtopPluginInit=Ee,e.iLoggerReportApi=Se,e.iLoggerSelfDefineFSP=me,Object.defineProperty(e,"__esModule",{value:!0})}));
